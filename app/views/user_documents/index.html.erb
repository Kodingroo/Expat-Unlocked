
<div class="container">
  <% unless current_user.first_name == "" %>
  <h1>
    <%= current_user.first_name %>'s Documents
  </h1>
  <% else %>
  <h1>My Documents</h1>
  <% end %>
  <p>Browse through all your uploaded documents</p>
</div>

<div class="filter">
  <%= form_tag user_documents_path, method: :get, class: "filter__form" do |f| %>
  <%= select_tag "sort_by", options_for_select(@sort_by, params[:sort_by]), id: "sort-by-select" %>
  <%= select_tag "category", options_for_select(@categories, params[:category]), id: "category-select" %>
  <% end %>
</div>

<div class="primary-wrapper">
  <div class="container">
    <div class="row">
      <% @user_documents.each do |doc| %>
      <div class="col-xs-12 col-md-4">
        <div class="banner card banner-direction-column">
          <%= link_to "", user_document_path(doc), class: "card__link", method: :get %>
          <div class="card__header">
            <h4 class="card__title">
              <%= doc.document.nil? ? "Unrecognizable Bill, Sorry" :
              doc.document.company_name %>
            </h4>
          </div>
          <div class="result-photo overflow-hidden">
            <%= cl_image_tag doc.photo.url, :width => 100, :crop => "fit" %>
          </div>

        </div>
      </div>
      <% end %>
    </div>
  </div>


</div>

<script>
  const sort_by_change = document.querySelector("#sort-by-select");
  const category_change = document.querySelector("#category-select");

  sort_by_change.addEventListener('change', (event) => {
    document.querySelector(".filter__form").submit();
  })
  category_change.addEventListener('change', (event) => {
    document.querySelector(".filter__form").submit();
  })
</script>
